(self.modernJsonp=self.modernJsonp||[]).push([["12608"],{784548:function(e,t,r){r.d(t,{$y:()=>i,AU:()=>u,VD:()=>p,_d:()=>o,am:()=>c,bj:()=>a,pv:()=>l,tb:()=>d,x1:()=>s});let n="local",o={INIT_CURRENT_USER_TRACKER:"INIT_CURRENT_USER_TRACKER",ADD_VISITED_PAGE:"ADD_VISITED_PAGE",ADD_COMPLETED_SEARCH:"ADD_COMPLETED_SEARCH",REMOVE_COMPLETED_SEARCH:"REMOVE_COMPLETED_SEARCH",ADD_CLICKTHROUGH_PIN:"ADD_CLICKTHROUGH_PIN",UPDATE_DOWNLOAD_COUNT:"UPDATE_DOWNLOAD_COUNT",UPDATE_SAVED_PINS:"UPDATE_SAVED_PINS",UPDATE_REVISITATION:"UPDATE_REVISITATION"},i=e=>({type:o.INIT_CURRENT_USER_TRACKER,payload:e}),a=(e,t)=>({type:o.ADD_VISITED_PAGE,payload:{path:e,pageType:t,storageType:n}}),s=e=>({type:o.ADD_COMPLETED_SEARCH,payload:{search:e,storageType:n}}),d=e=>({type:o.REMOVE_COMPLETED_SEARCH,payload:{query:e,storageType:n}}),c=e=>({type:o.ADD_CLICKTHROUGH_PIN,payload:{pin:e,storageType:n}}),u=()=>({type:o.UPDATE_DOWNLOAD_COUNT,payload:{storageType:n}}),l=e=>({type:o.UPDATE_SAVED_PINS,payload:{pins:e,storageType:n}}),p=e=>({type:o.UPDATE_REVISITATION,payload:{revisitation:e,storageType:n}})},293123:function(e,t,r){r.d(t,{$2:()=>f,EI:()=>_,HY:()=>S,Ku:()=>R,LI:()=>m,V5:()=>I,Vz:()=>p,aJ:()=>g,cn:()=>T,cq:()=>A,eo:()=>y,jo:()=>h,yb:()=>E});var n=r(4533),o=r(994507),i=r(971258),a=r(52433),s=r(34550),d=r(418282),c=r(163691),u=r(767415);function l(e){return"local"===e?(0,s.M0)():(0,d.Nl)()}let p=(e="local")=>{try{let t=l(e);if(!t.accessAllowed)return o.PW;return(t.getItem(n.pm)||o.PW).map(e=>({...e,path:(0,a.Z)(e.path)}))}catch(e){return(0,u.nP)("current_user_tracker.storage.get_visited_pages.error"),o.PW}},_=(e,t,r="local")=>{try{let s=l(r);if(!s.accessAllowed)return;let d=(0,a.Z)(e),c=[...p(r)],u=(0,i.b8)(c,d,t,o.LG);u!==c&&s.setItem(n.pm,u)}catch(e){(0,u.nP)("current_user_tracker.storage.add_visited_page.error")}},E=(e="local")=>{try{let t=l(e);if(!t.accessAllowed)return o.fE;return t.getItem(n.ny)||o.fE}catch(e){return(0,u.nP)("current_user_tracker.storage.get_completed_searches.error"),o.fE}},f=(e,t="local")=>{try{let r=l(t);if(!r.accessAllowed)return;let a=[...E(t)],s=(0,i.aq)(a,e,o.LG);s!==a&&r.setItem(n.ny,s)}catch(e){(0,u.nP)("current_user_tracker.storage.add_completed_search.error")}},y=(e,t="local")=>{try{let r=l(t);if(!r.accessAllowed)return;let o=[...E(t)],a=(0,i.zz)(o,e);r.setItem(n.ny,a)}catch(e){(0,u.nP)("current_user_tracker.storage.remove_completed_search.error")}},R=(e="local")=>{try{let t=l(e);if(!t.accessAllowed)return o.iK;return t.getItem(n.Vb)||o.iK}catch(e){return(0,u.nP)("current_user_tracker.storage.get_clickthrough_pins.error"),o.iK}},m=(e,t="local")=>{try{let r=l(t);if(!r.accessAllowed)return;let a=[...R(t)],s=(0,i.UP)(a,e,o.LG);s!==a&&r.setItem(n.Vb,s)}catch(e){(0,u.nP)("current_user_tracker.storage.add_clickthrough_pin.error")}},g=(e="local")=>{try{let t=l(e);if(!t.accessAllowed)return o.cH;return parseInt(t.getItem(n.rN)||String(o.cH),10)}catch(e){return(0,u.nP)("current_user_tracker.storage.get_download_count.error"),o.cH}},I=(e,t="local")=>{try{let r=l(t);if(!r.accessAllowed)return;r.setItem(n.rN,e.toString())}catch(e){(0,u.nP)("current_user_tracker.storage.set_download_count.error")}},T=(e="local")=>{try{let t=l(e);if(!t.accessAllowed)return o.pn;return t.getItem(n.s1)??o.pn}catch(e){return(0,u.nP)("current_user_tracker.storage.get_saved_pins.error"),o.pn}},A=(e,t="local")=>{try{let r=l(t);if(!r.accessAllowed)return;r.setItem(n.s1,e)}catch(e){(0,u.nP)("current_user_tracker.storage.set_saved_pins.error")}},h=(e="local")=>{try{let t=l(e);if(!t.accessAllowed)return(0,o.dm)();let{count:r,time:i,ts:a,sessionTimestamps:s}=t.getItem(n.SI)??{};if("number"==typeof r&&"number"==typeof i&&"number"==typeof a){let e=Array.isArray(s)&&s.every(e=>"number"==typeof e)?s:void 0;return{count:r,time:i,ts:a,sessionTimestamps:e}}return(0,o.dm)()}catch(e){return(0,u.nP)("current_user_tracker.storage.get_revisitation.error"),(0,o.dm)()}},S=(e,t="local")=>{try{let r=l(t);if(!r.accessAllowed)return;r.setItem(n.SI,(0,c.Z)(e))}catch(e){(0,u.nP)("current_user_tracker.storage.set_revisitation.error")}}},971258:function(e,t,r){r.d(t,{UP:()=>d,aq:()=>s,b8:()=>a,zz:()=>c});var n=r(52433),o=r(163691);let i=(e,t,r)=>{let n=[t,...e];return n.length>r?n.slice(0,r):n},a=(e,t,r,a)=>{let s=(0,n.Z)(t);return((e,t)=>{let r=e.length,o=(0,n.Z)(t),i=r?(0,n.Z)(e[0].path):"";return!r||o!==i})(e,s)?i(e,(0,o.Z)({path:s,pageType:r}),a):e},s=(e,t,r)=>((e,t)=>{let r=e.length,n=r?e[0].query:"";return!r||t!==n})(e,t.query)?i(e,(0,o.Z)(t),r):e,d=(e,t,r)=>((e,t)=>{let r=e.length,n=r?e[0].pinId:"";return!r||t!==n})(e,t.pinId)?i(e,(0,o.Z)(t),r):e,c=(e,t)=>e.filter(e=>e.query!==t)},52433:function(e,t,r){r.d(t,{Z:()=>o});var n=r(197908);function o(e){let t=(0,n.Z)(e);return t?`/pin/${t}/`:e}},470205:function(e,t,r){r.d(t,{Z:()=>n});let n=r(817468).Z},935059:function(e,t,r){r.d(t,{$:()=>n,Z:()=>i});let{Provider:n,get:o}=(0,r(213491).Z)("viewer"),i=o},583845:function(e,t,r){r.d(t,{Rq:()=>n,Vf:()=>o,jd:()=>i,oy:()=>a});let n=e=>"ios"===e&&(window.devicePixelRatio||1)*window.screen.height==2436,o=28,i=e=>window.innerHeight>=748&&n(e),a=()=>"undefined"!=typeof window&&!!window.navigator&&(/iPad/.test(navigator.platform)||"MacIntel"===navigator.platform&&"ontouchend"in document&&Math.min(window.screen.width,window.screen.height)>=700)},250026:function(e,t,r){r.d(t,{Z:()=>n});function n(e,t,r,o=0){if(-1===t||-1===r||t===r)return e;let i=r+o,a=t+o;if(i<0||i>=e.length||a<0||a>=e.length)return e;let s=[...e],d=s[a],c=a<i?1:-1;for(let t=a;t!==i;t+=c)s[t]=e[t+c];return s[i]=d,s}},774838:function(e,t,r){r.d(t,{B:()=>i,P2:()=>s,Ts:()=>o,gf:()=>a});let n=r(969634),{getRequestContext:o}=n,{useRequestContext:i}=n,{useUpdateRequestContext:a}=n,{RequestContextProvider:s}=n},969634:function(e,t,r){r.r(t),r.d(t,{RequestContextProvider:()=>c,getRequestContext:()=>d,useRequestContext:()=>u,useUpdateRequestContext:()=>l});var n=r(667294),o=r(659541),i=r(907049),a=r(785893);let s=(0,n.createContext)(null);function d(){return(0,n.use)(s).requestContextState}function c({children:e,initialValue:t}){let[r,d]=(0,n.useState)(t),c=(0,n.useMemo)(()=>({requestContextState:r,updateRequestContext:e=>{let t={...r,...e};(0,i.Z)(r,e)||d(t),(0,o.J)(t)}}),[r]);return(0,a.jsx)(s,{value:c,children:e})}function u(){let e=(0,n.use)(s);if(!e)throw Error("useRequestContext must be used within a RequestContextProvider");return e.requestContextState}function l(){let e=(0,n.use)(s);if(!e)throw Error("useUpdateRequestContext must be used within a RequestContextProvider");return e.updateRequestContext}},317109:function(e,t,r){r.d(t,{Z:()=>d});var n=r(686659),o=r(667294),i=r(653015);function a({children:e}){if("undefined"==typeof window)throw Error(i.u);return e}var s=r(785893);function d({children:e,fallback:t}){return(0,o.useEffect)(()=>{(0,n.Z)("SafeSuspense","/app/packages/safe-suspense/SafeSuspense.tsx")},[]),(0,s.jsx)(o.Suspense,{fallback:t,children:(0,s.jsx)(a,{children:e})})}},405897:function(e,t,r){r.d(t,{i:()=>n});let n={AC:"ac",AUTOCOMPLETE:"autocomplete",BOARD:"blp",CONTENT_TYPE_FILTER:"content_type_filter",DIRECT_NAVIGATION:"direct_navigation",FILTER:"filter",GUIDED_SEARCH_ENTRY:"guided_search_entry",GUIDED_SEARCH_LANDING:"guided_search_landing",HASHTAG_CLOSEUP:"hashtag_closeup",HASHTAG_PINREP:"hashtag_pinrep",HOMEFEED_BUBBLE:"homefeed_bubble",HUB_PAGE:"hub_page",IDEAS_ROOT:"ideas_root",IMAGE_ONLY_ATTRIBUTION:"image_only_attribution",LANDING_PAGE_STORY:"landing_page_story",NO_RESULTS_SEARCH_STORY:"no_results_search_story",PRODUCT:"product",REMOVE:"remove",RS:"rs",SHOPPING_FILTER:"shopping_filter",SITELINKS_SEARCHBOX:"sitelinks_searchbox",SLP_REC_CURATED:"slp_rec_curated",SLP_REC_TRENDING:"slp_rec_trending",SRS:"srs",STRUCTURED_GUIDE:"structured_guide",TRENDING:"trending",TYPED:"typed",TYPO_AUTO_ORIGINAL:"typo_auto_original",TYPO_SUGGESTION:"typo_suggestion",UNKNOWN:"Unknown",URECS:"urecs",VANILLA_GUIDE:"guide",VIDEO:"video",VOICE_SEARCH:"voice_search"}},748025:function(e,t,r){r.d(t,{Z:()=>i});var n=r(236269),o=r(935833);function i(){let e=navigator.serviceWorker;return e&&e.getRegistration?((0,o.My)("mweb_service_worker.unregister_attempt"),e.getRegistration().then(e=>{if(e)return e.unregister().then(()=>((0,o.My)("mweb_service_worker.unregister_success"),navigator.serviceWorker&&window.caches?window.caches.keys().then(e=>{let t=e.find(e=>e.startsWith("workbox-precaching"));return t?window.caches.delete(t):null}).then(()=>(0,o.My)("mweb_service_worker.clear_app_shell")):Promise.resolve())).catch(e=>{(0,o.tj)("mweb_service_worker.unregister_fail",{error:(0,n.Z)(e,"message")})})})):Promise.resolve()}},907049:function(e,t,r){r.d(t,{Z:()=>n});function n(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;let r=Object.keys(e),n=Object.keys(t);return r.length===n.length&&r.every(r=>e[r]===t[r])}},197908:function(e,t,r){r.d(t,{Z:()=>i});var n=r(854897),o=r(99737);let i=e=>{let t=/^\/pin\/([a-zA-Z0-9-]+)/,r=(0,o.Z)(e);if(t.test(r.path)){let e=r.path.match(t);if(e)return(0,n.Z)(e[1]).pinId||void 0}}},854897:function(e,t,r){r.d(t,{Z:()=>n});function n(e){if((e||"").includes("--")){let t=e.split("--"),r=t.pop();return{text:t.join("--"),pinId:r}}return{text:"",pinId:e}}},778555:function(e,t,r){r.d(t,{Z:()=>i});var n=r(925201),o=r(341687);let i=(e,t)=>{if(0===t.length)return e;let[r,i]=e.split("?"),a=Object.entries((0,o.Z)(i)).filter(([e])=>!t.includes(e)).reduce((e,[t,r])=>({...e,[t]:r}),{});return(0,n.Z)(r,a)}},64892:function(e,t,r){r.d(t,{GW:()=>o,RL:()=>n,s4:()=>i});let n="ios",o="android",i="ipad"},281213:function(e,t,r){r.d(t,{H:()=>c,W:()=>u});var n=r(667294),o=r(230201),i=r(213491),a=r(501010),s=r(785893);let{Provider:d,get:c}=(0,i.Z)("VideoPlayer");function u({children:e}){let{logContextEvent:t,logImpression:r}=(0,o.u)(),{checkExperiment:i}=(0,a.Z)(),[c,u]=(0,n.useState)(!1),[l,p]=(0,n.useState)([]),[_,E]=(0,n.useState)([]),[f,y]=(0,n.useState)({}),R=i("web_ads_mrc_video_impression").anyEnabled,m=e=>{y(t=>({...t,[e]:!0}))},g=(0,n.useCallback)(e=>{if(18===e.event_type&&e.event_data?.pinImpressions?.length){let{isNativeVideoAndWatchable:t}=e.event_data.pinImpressions[0],r=JSON.stringify(e.aux_data?.commerce_data||"").includes("story_pin_id");R&&(t||r)&&p(t=>[...t,e].slice(-1e3))}},[R]),I=(0,n.useCallback)(e=>{18===e.eventType&&R&&E(t=>[...t,e].slice(-1e3))},[R]);(0,n.useEffect)(()=>{let e=l.filter(e=>{let{pinIdStr:r}=e.event_data.pinImpressions[0];return!f[r]||!R||(t((e=>{let{time:t}=e.event_data.pinImpressions[0];return{...e,event_data:{...e.event_data,pinImpressions:[{...e.event_data.pinImpressions[0],isMrcBtr:!0,endTime:t,renderDuration:0}]}}})(e)),!1)});e.length!==l.length&&p(e)},[l,R,t,f]),(0,n.useEffect)(()=>{let e=_.filter(e=>{let t=e.eventData?.pinIdStr;if(!t)return!1;if(f[t]&&R){let t=(e=>{if(e.eventData){let{time:t}=e.eventData;return{...e,eventData:{...e.eventData,isMrcBtr:!0,endTime:t??0}}}return null})(e);return t&&r(t),!1}return!0});e.length!==_.length&&E(e)},[_,R,r,f]);let T=(0,n.useMemo)(()=>({captionsEnabled:c,logMrcVideoAdImpressionOnPlay:I,logMrcVideoAdEventOnPlay:g,setCaptionsEnabled:u,setVideoPlayed:m,videosPlayed:f}),[c,g,I,f]);return(0,s.jsx)(d,{value:T,children:e})}},163691:function(e,t,r){r.d(t,{Z:()=>n});let n=function(e){return{...e,ts:Date.now()}}},658337:function(e,t,r){r.d(t,{J:()=>E,Z:()=>m});var n=r(250026),o=r(184661),i=r(42676),a=r(830949),s=r(407775),d=r(210730),c=r(438274);let u=new Set(["PinResource","RepinResource"]),l={ApiResource:e=>e?.url==="/v3/orientation/nux_creator_recommendations/"?"nux-creator-recommendations":e?.url==="/v3/users/me/interests/"?`recommended-interests:${e.data?.blend_type}`:e?.url===`/v3/usecases/${e.data?.use_case_id}/feed/`?"useCaseFeed":e?.url===`/v3/boards/${e.data?.board_id}/automagical/pins/`?`automagical-board-feed:${e.data?.board_id}`:e?.url===`/v3/aggregated_pin_data/${e.data?.aggregated_pin_data}/comments/`?`aggregated-comments:${e.data?.aggregated_pin_data}`:e?.url==="/v3/users/me/boards/archived/"?"archived-boards":"",AggregatedActivityFeedResource:e=>`trieditfeed:${e.aggregated_pin_data_id}`,AggregatedCommentReplyFeedResource:e=>`${c.Z.AGGREGATED_COMMENT_REPLIES}:${e.objectId}`,BoardlessPinsResource:e=>`boardless-pins:${e.userId}`,BestPinsFeedAltResource:e=>`idea-page-best-pins:${e.interest}`,BoardContentRecommendationResource:e=>`recommendation-feed:${e.id}`,BoardFeedResource:e=>`boardfeed:${e.board_id}`,BoardSectionsRepinResource:e=>`board-sections:${e.board_id}`,BoardSectionsResource:e=>`board-sections:${e.board_id}`,BoardSectionPinsResource:e=>`board-section-pins:${e.section_id}`,BoardsFeedResource:e=>`profile-boards:${e.username}`,BoardToolsFeedResource:e=>`board-tools:${e.boardId}`,ConversationsResource:()=>"conversations",DidItUserFeedResource:e=>`profile-tried:${e.username}`,InterestResource:e=>`klp-pins:${e.interest}`,MoreIdeasTabsBoardsResource:()=>"homefeed-more-ideas-tabs",NewsHubResource:()=>"notifications",NewsHubDetailsResource:e=>`newshubdetail:${e.news_id}`,NuxInterestsResource:()=>"nuxTopics",PinsFromBrandResource:e=>`brand-pins:${e.pin}`,ReactionsResource:e=>`reactions:${e.pin_id}`,RelatedArticlesResource:e=>`related-articles:${e.article_id}`,RelatedModulesResource:e=>`related-modules:${e.pin_id}`,RelatedPinFeedResource:e=>`related-pins:${e.pin}`,RelatedStreamResource:e=>`related-story-pins:${e.pinId}`,SearchResource:e=>`search:${(0,i.Tb)(e)}`,BaseSearchResource:e=>`search:${(0,i.Tb)(e)}`,SectionToolsFeedResource:e=>`section-tools:${e.sectionId}`,ShareSuggestionsTypeaheadResource:e=>`share-suggestions:${e.board||e.user}:${e.term}`,StoryFeedResource:e=>`story-feed:${e.feed_type}:${e.request_params}`,StoryPinTaggedProductsResource:()=>"story-pin-tagged-products",TodayArticleFeedResource:e=>`today-article:${e.id}`,TodayTabInterestFeedResource:e=>`today-article-interestfeed:${e.interest_id}`,TodayTabResource:()=>"today-tab",SeoTier1CandidateResource:()=>"tier1-feed",UnifiedCommentsResource:e=>`unified-comments:${e.aggregated_pin_id}`,UserActivityPinsResource:e=>`profile-pins-feed:${e.user_id}`,UserHomefeedResource:e=>e.pin_quiz?"pin-quiz":"homefeed",UserFollowingResource:e=>`user-following:${e.username}`,UserRecentActivityResource:e=>`user-recent-activity:${e.filter_type}`,UserStoryPinsFeedResource:e=>`story-pins-feed:${e.user_id}`,VisualLiveSearchResource:e=>`visual-search:${e.pin_id}:${e.crop.x}${e.crop.y}${e.crop.w}${e.crop.h}`,VisualLiveSearchProductFeedResource:e=>`visual-search-products:${e.pin_id}:${e.crop.x}${e.crop.y}${e.crop.w}${e.crop.h}`,VisualSearchFlashlightUnifiedResource:e=>`related-products-unified:${e.pin_id}`,InterestFollowingResource:e=>`topic-following:${e.username}`,UserPinsResource:e=>`profile-pins:${e.username}`,TopicFeedResource:e=>e.best_pins?`best-topic-pins:${e.interest}`:`topic-pins:${e.interest}`},p={AggregatedActivityFeedResource:({options:{aggregated_pin_data_id:e}})=>({type:c.Z.TRIED_IT_FEED,id:e}),AggregatedCommentReplyFeedResource:({options:{isUnifiedComment:e,objectId:t}})=>({type:e?c.Z.AGGREGATED_COMMENT_REPLIES:c.Z.AGGREGATED_COMMENTS,id:t,reversed:!0}),ApiResource:({options:{url:e,data:t}})=>e===`/v3/usecases/${t?.use_case_id}/feed/`?{type:c.Z.USE_CASE_TAB,id:t.use_case_id}:e===`/v3/boards/${t?.board_id}/automagical/pins/`?{type:c.Z.AUTOMAGICAL_BOARD_FEED,id:t.board_id}:e===`/v3/aggregated_comments/${t.aggregated_comment}/replies/`?{type:t.isUnifiedComment?c.Z.AGGREGATED_COMMENT_REPLIES:c.Z.AGGREGATED_COMMENTS,id:t.aggregated_comment,reversed:!0}:e===`/v3/aggregated_pin_data/${t?.aggregated_pin_data}/comments/`?{type:c.Z.AGGREGATED_COMMENTS,id:t.aggregated_pin_data}:null,BoardFeedResource:({options:{board_id:e}})=>({type:c.Z.BOARDFEED,id:e}),BoardlessPinsResource:({options:{userId:e}})=>({type:c.Z.BOARDLESS_PINS,id:e}),BoardSectionPinsResource:({options:{section_id:e}})=>({type:c.Z.BOARD_SECTION_PINS,id:e}),BoardSectionsResource:({options:{board_id:e}})=>({type:c.Z.BOARD_SECTIONS,id:e}),BoardsResource:({options:{username:e,sort:t,filter_types:r}})=>({type:c.Z.PROFILE_BOARDS,id:(0,a.Z)(e,t,r)}),BaseSearchResource:({options:e,response:t})=>({type:c.Z.SEARCH_PINS,id:(0,i.Tb)(e),items:t.resource_response.data?.results||[]}),DidItCommentsResource:({options:{objectId:e}})=>({type:c.Z.AGGREGATED_COMMENTS,id:e,reversed:!0}),DidItUserFeedResource:({options:{username:e}})=>({type:c.Z.TRIED_IT_FEED,id:e}),RelatedArticlesResource:({options:{article_id:e}})=>({type:c.Z.TODAY_TAB,id:e}),StoryPinDraftsResource:({options:{userId:e}})=>({type:c.Z.STORY_PIN_DATA,id:e}),TodayTabInterestFeedResource:({options:{interest_id:e}})=>({type:c.Z.TODAY_ARTICLE_INTEREST_FEED,id:e}),TodayTabResource:()=>({type:c.Z.TODAY_TAB,id:"todayTab"}),UnifiedCommentsPreviewResource:({options:{aggregated_pin_id:e}})=>({type:c.Z.UNIFIED_COMMENTS,id:e}),UnifiedCommentsResource:({options:{aggregated_pin_id:e,is_reversed:t}})=>({type:c.Z.UNIFIED_COMMENTS,id:e,reversed:t}),UserActivityPinsResource:({options:{user_id:e}})=>({type:c.Z.PROFILE_PINS_FEED,id:e}),UserStoryPinsFeedResource:({response:e,options:{user_id:t}})=>({type:c.Z.STORY_PINS_FEED,id:t,items:e.resource_response.data||[]})},_=(e,{pinId:t,oldFeedId:r,newFeedId:n})=>r===n?e:((e,{pinId:t,feedId:r})=>e[r]?{...e,[r]:[{type:"pin",id:t},...e[r]]}:e)(((e,{pinId:t,feedId:r})=>e[r]?{...e,[r]:e[r].filter(e=>"pin"!==e.type||e.id!==t)}:e)(e,{pinId:t,feedId:r}),{pinId:t,feedId:n}),E=(e,t)=>e in l?l[e](t):null,f=(e,t)=>t?`board-section-pins:${t}`:`boardfeed:${e}`,y=(e,t)=>e.map(e=>{let{id:r,schema:n,type:o}=e;return"home_feed_tabs"===o?e:n?{id:r,type:n,trackingParams:"pin"===n?t.pins[r].tracking_params:void 0,user_id:void 0}:null}).filter(Boolean),R=(e,t,r)=>Object.keys(e).reduce((n,o)=>{let i=e[o]||[],a=i.filter(e=>{if(e.type!==t)return!0;if("reaction"===t){let t=e.id.lastIndexOf(":");return e.id.substring(0,t)!==r}return e.id!==r});return i.length!==a.length&&(n[o]=a),n},{...e}),m=(e={},t)=>{switch(t.type){case o.zP:case o.aW:{let{payload:r}=t,{resource:n,options:i,normalizedResponse:a,schema:u}=r;if(a&&n in l){let r=((e,t,r)=>{let n=r||s.Z[e];if(n===d.LR)return t.result;if(n===d.sN)return t.result.map(e=>({id:e,schema:"board"}));if(n===d.Gn)return t.result.map(e=>({id:e,schema:"user"}));if(n===d.Ht)return t.result.map(e=>({id:e,schema:"invite"}));if(n===d.fE)return t.result.map(e=>({id:e,schema:"reaction"}));if("object"==typeof n){let e=Object.entries(n).find(([,e])=>e===d.LR);if(e)return t.result[e[0]]}return null})(n,a,u);if(r&&Array.isArray(r)){let s=n in l?l[n](i):null;if(!s)return e;if("BoardToolsFeedResource"===n||"SectionToolsFeedResource"===n)return{...e,[s]:r};if("UnifiedCommentsResource"===n){let n=y(r,a.entities);if(e[s]&&(o.zP||o.aW===t.type))return{...e,[s]:[...e[s],...n]};return{...e,[s]:n}}{let n=[...t.type===o.aW&&e[s]||[],...y(r,a.entities)];return{...e,[s]:n}}}}else{let{data:n}=r.response.resource_response;if(!r.options?.redux_normalize_feed)return e;let i=p[r.resource]({options:r.options,response:r.response});if(i){let{type:r,id:a,items:s,reversed:d}=i,u=(s||n||[]).filter(Boolean).map(e=>((e,t)=>{switch(e.type){case"story":return{id:e.id??"",type:"story",story_type:e.story_type??""};case"module":return{id:e.id,type:"module",name:e.name};case"user":return{id:e.id,type:"user"};case"board":return t===c.Z.PROFILE_BOARDS?{id:e.id,type:"board",onProfile:!0,profileGroup:e.archived_by_me_at?"archived":e.privacy||"public"}:{id:e.id,type:"board",onProfile:!1};case"board_section":return{type:"boardsection",id:e.id};case"triedit":return{type:"triedit",id:e.id};case"aggregatedcomment":return{type:"aggregatedcomment",id:e.id};case"home_feed_tab":return{type:"home_feed_tab",id:e.id,name:e.name};case"storypindata":return{id:e.id,type:"storypindata"};case"todayarticle":return{type:"todayarticle",id:e.id};case"unifiedcommentspreview":return"userdiditdata"===e.unified_comment.type?{type:"triedit",id:e.unified_comment.id}:{type:"aggregatedcomment",id:e.unified_comment.id};default:let r="useCaseFeed"===t&&"tracking_params"in e;return{type:"pin",id:e.id??"",...r&&{trackingParams:e.tracking_params}}}})(e,r));d&&(u=u.reverse());let l=`${r}:${a}`,p=e[l];if(p||t.type!==o.aW){let r=p||[],n=u;return t.type===o.aW&&(n=d?u.concat(r):r.concat(u)),{...e,[l]:n}}}}break}case"FEED_ITEM_REORDERED":{let{payload:{feedType:r,feedId:o,itemType:i,targetItemId:a,sourceItemId:s}}=t,d=`${r}:${o}`,u=e[d]||[],l=-1,p=-1;if([c.Z.BOARDFEED,c.Z.BOARD_SECTION_PINS,c.Z.BOARD_SECTIONS,"profileBoards"].includes(r)&&(l=u.findIndex(e=>e.type===i&&e.id===s),p=u.findIndex(e=>e.type===i&&e.id===a)),-1!==l&&-1!==p)return{...e,[d]:(0,n.Z)(u,l,p)};break}case"FEED_ITEMS_REMOVED":{let{payload:{feedType:r,feedId:n,inverseSelection:o,itemType:i,itemIds:a=[]}}=t,s=`${r}:${n}`,d=e[s]||[];if(d&&d.length>0&&(r===c.Z.BOARD_SECTION_PINS||r===c.Z.BOARDFEED)){let t=d.filter(e=>{let t=a.includes(e.id);return!(e.type===i&&(o&&!t||!o&&t))}),r=!!t.find(e=>"pin"===e.type);return{...e,[s]:r?t:[]}}if(d&&d.length>0&&r===c.Z.BOARD_SECTIONS||d&&d.length>0&&(r===c.Z.AGGREGATED_COMMENTS||r===c.Z.BOARDLESS_PINS||r===c.Z.PROFILE_PINS_FEED||r===c.Z.STORY_PINS_FEED||r===c.Z.UNIFIED_COMMENTS||r===c.Z.TRIED_IT_FEED||r===c.Z.STORY_PIN_DATA)){let t=d.filter(e=>{let t=a.includes(e.id);return!(e.type===i&&t)});return{...e,[s]:t}}break}case"FEED_ITEMS_ADDED":{let{payload:{feedType:r,feedId:n,itemType:o,itemIds:i=[],prepend:a}}=t,s=`${r}:${n}`,d=e[s]||[];if(d&&(r===c.Z.BOARD_SECTION_PINS||r===c.Z.BOARDFEED||r===c.Z.BOARDLESS_PINS)){let t=i.map(e=>({id:e,type:o})),r=0;"story"===(d[0]||{}).type&&(r=1),"story"===(d[1]||{}).type&&(r=2);let n=[...d.slice(0,r),...t,...d.slice(r)];return{...e,[s]:n}}if(d&&r===c.Z.BOARD_SECTIONS){let t=[...i].reverse().map(e=>({id:e,type:"boardsection"})),r=d?[...t,...d]:[...t];return{...e,[s]:r}}if(r===c.Z.AGGREGATED_COMMENTS||r===c.Z.AGGREGATED_COMMENT_REPLIES||r===c.Z.PROFILE_PINS_FEED||r===c.Z.STORY_PINS_FEED||r===c.Z.UNIFIED_COMMENTS){let t=i.map(e=>({id:e,type:o})),r=d?[...a?t:d,...a?d:t]:t;return{...e,[s]:r}}if(r===c.Z.TRIED_IT_FEED){let t=i.map(e=>({id:e,type:o})),r=d?[...t,...d]:t;return{...e,[s]:r}}break}case"FEED_INVALIDATE":{let{payload:{feedType:r,feedId:n}}=t,o=`${r}:${n}`;return e[o],{...e,[o]:null}}case"APPEND_FEED_ITEMS":{let{payload:{id:r,items:n,options:o}}=t,i=e[r];if(!i)return{...e,[r]:n};{let t;return t=o.isPrepend?i[0]&&"story"===i[0].type?[].concat(i[0],n,i.slice(1)):n.concat(i):i.concat(n),{...e,[r]:t}}}case"PIN_DELETE":{let{payload:{pinId:r}}=t;return R(e,"pin",r)}case"BOARD_ARCHIVE":{let{payload:{boardId:r,username:n}}=t,o=`profile-boards:${n??""}`;if(e[o])return{...e,[o]:e[o].filter(e=>e.id!==r)};break}case"BOARD_UNARCHIVE":{let{payload:{boardId:r}}=t,n="archived-boards";if(e[n])return{...e,[n]:e[n].filter(e=>e.id!==r)};break}case"BOARD_DELETE":{let{payload:{boardId:r}}=t;return R(e,"board",r)}case"BOARD_SECTION_DELETE":{let{payload:{boardSectionId:r}}=t;return R(e,"boardsection",r)}case"PINS_MOVE":{let{payload:{source:r,target:n,pinIds:o,userId:i}}=t,a=r.boardlessPins&&i&&`boardless-pins:${i}`||r.boardId&&f(r.boardId,r.sectionId),s=f(n.boardId,n.sectionId);return o.reduce((e,t)=>_(e,{pinId:t,oldFeedId:a,newFeedId:s}),e)}case"PINS_MOVE_ALL":{let{payload:{source:r,target:n,excludePinIds:o}}=t,i=f(r.boardId,r.sectionId),a=f(n.boardId,n.sectionId),s={...e,[i]:o.map(e=>({type:"pin",id:e}))};return delete s[a],s}case"PIN_EDIT":{let{payload:{pinId:r,boardId:n,sectionId:o="",source:{boardId:i,sectionId:a}}}=t;return _(e,{pinId:r,oldFeedId:f(i,a),newFeedId:f(n,o)})}case o.AF:if(u.has(t.payload.resource)){let r,n=t.payload.response.resource_response.data,{board:o}=n;if("quick_saves"===o.layout)r=`boardless-pins:${t.payload.options.user_id}`;else{let e=t.payload.options.section;r=e?`board-section-pins:${e}`:`boardfeed:${o.id}`}if(e[r]){let t={...e},o={id:n.id,type:"pin",trackingParams:n?.tracking_params};return t[r]=[o].concat(e[r]),t}}if("BoardSectionResource"===t.payload.resource&&t.payload.normalizedResponse){let r=t.payload.normalizedResponse.result,n=t.payload.normalizedResponse.entities.boardsections?.[r].board;if(!n)return e;let o=`board-sections:${n}`;if(e[o]){let t={...e};return t[o]=[{id:r,type:"boardsection"}].concat(e[o]),t}}if("AggregatedCommentResource"===t.payload.resource&&t.payload.normalizedResponse){let r={id:t.payload.normalizedResponse.result,type:"aggregatedcomment"},n={...e};for(let o of["aggregated-comments","unified-comments"]){let i=`${o}:${t.payload.options.objectId}`;e[i]&&(n={...n,[i]:[r].concat(n[i])})}return n}if("AggregatedCommentReplyResource"===t.payload.resource&&t.payload.normalizedResponse){let r=`${c.Z.AGGREGATED_COMMENT_REPLIES}:${t.payload.options.objectId}`;return{...e,[r]:[...e[r]||[],{id:t.payload.normalizedResponse.result,type:"aggregatedComment"}]}}if("ReactionsResource"===t.payload.resource&&t.payload.normalizedResponse){let{reaction_pin_id:r,reaction_type:n}=t.payload.options;if("reaction"===t.payload.options.action_type){let o=`reactions:${t.payload.options.pin_id}`,i={...e},a={id:`${r}:${t.payload.options.user_id}:${n}`,type:"reaction",trackingParams:void 0};return i[o]=[a].concat(e[o]),i}if("unreaction"===t.payload.options.action_type)return R(e,"reaction",`${r}:${t.payload.options.user_id}`)}}return e}},405933:function(e,t,r){r.d(t,{$:()=>g,G:()=>I});var n=r(686659),o=r(667294),i=r(422578),a=r(312048),s=r(244311),d=r(501010),c=r(774838);function u(e){let t={result:{kind:"Pending",promise:e},read:()=>(function(e){let{result:t}=e;switch(t.kind){case"Pending":throw t.promise;case"Ok":return t.value;case"Err":throw t.error;default:throw Error("Unexpected case")}})(t)};return e.then(e=>{t.result={kind:"Ok",value:e}}).catch(e=>{t.result={kind:"Err",error:e}}),t}function l(e){return{result:{kind:"Ok",value:e},read:()=>e}}var p=r(362777),_=r(335562),E=r(767415),f=r(785893);let y=(0,o.createContext)(null),R=/(^\/)|:|(\/$)/g,m=/\//g,g=({children:e})=>{(0,o.useEffect)(()=>{(0,n.Z)("EntrypointContext","/pws/entrypoint-router/EntrypointContext.tsx")},[]);let t=(0,i.useRelayEnvironment)(),{checkExperiment:r}=(0,d.Z)(),s=(0,c.B)(),u=(0,o.useRef)({}),l=(0,o.useCallback)(e=>{let{rootComponent:n,loadedValueState:o}=A(T(u.current,e),e,"Both",t,r,s);return"NotYetRendered"===o.performanceLoggingState.kind&&(o.performanceLoggingState={kind:"InitiallyRendered",initialRenderTime:Date.now()}),{rootComponent:n,onEntrypointDataLoaded:t=>{if("InitiallyRendered"===o.performanceLoggingState.kind){let r=Date.now();(0,E.LY)("entrypointRouter.routeTiming."+e.kind.replace(R,"").replace(m,"_"),r-o.performanceLoggingState.initialRenderTime,{sampleRate:.1,tags:t??{}}),o.performanceLoggingState={kind:"Complete"}}},loadedValue:o.loadedValue}},[r,t,s]),_=(0,a.s0)(),g=(0,o.useCallback)(e=>{A(T(u.current,e),e,"Both",t,r,s),_((0,p.w)(e))},[_,r,t,s]),I=(0,o.useCallback)((e,n)=>{let o=T(u.current,e);"Both"===n&&A(o,e,n,t,r,s)},[r,t,s]),h=(0,o.useMemo)(()=>({loadAndReadDuringRender__INTERNAL:l,preload:I,imperativelyNavigate:g}),[l,g,I]);return(0,f.jsx)(y,{value:h,children:e})};function I(){let e=(0,o.use)(y);if(null==e)throw Error("Missing entrypoint context");return e}function T(e,t){let r=p.Z[t.kind];if(null==r)throw Error("Unexpected missing route! Did you define it in routeMap.ts?");let n=r.loader();return e[t.kind]??={rootComponent:u(r.rootComponent()),loadedValueStates:{},loader:(0,s.isPromise)(n)?u(n):l(n)}}function A(e,t,r,n,o,i){var a;let s=JSON.stringify((0,_.Z)(t.routeParams)),{loadedValueStates:d,rootComponent:c,loader:p}=e;return{rootComponent:c,loadedValueState:d[s]??=(a=t.kind,setTimeout(()=>{let e=d[s];null!=e&&(0,E.nP)("entrypointRouter.entrypointUse",{sampleRate:.1,tags:{routeName:a,usedInTime:"NotYetRendered"!==e.performanceLoggingState.kind}})},3e4),{loadedValue:function(e,t){let{result:r}=e;switch(r.kind){case"Pending":return u(r.promise.then(t));case"Ok":return l(t(r.value));case"Err":var n;return{result:{kind:"Err",error:n=r.error},read:()=>{throw n}};default:throw Error("Unexpected case")}}(p,e=>e({routeParams:t.routeParams,relayEnvironment:n,checkExperiment:o,requestContext:i})),performanceLoggingState:{kind:"NotYetRendered"}})}}},362777:function(e,t,r){r.d(t,{w:()=>i,Z:()=>o});var n=r(312048);let o={"/collage-creation-tool":{loader:()=>Promise.all([r.e("92160"),r.e("50444")]).then(r.bind(r,231718)).then(e=>e.default),rootComponent:()=>Promise.all([r.e("39366"),r.e("25418"),r.e("19007"),r.e("92160"),r.e("73269"),r.e("10123"),r.e("42480"),r.e("10352"),r.e("40157"),r.e("76201")]).then(r.bind(r,944181)).then(e=>e.default)},"/comparison/results":{loader:()=>r.e("77087").then(r.bind(r,531297)).then(e=>e.default),rootComponent:()=>Promise.all([r.e("39366"),r.e("25418"),r.e("31417"),r.e("21398"),r.e("69519")]).then(r.bind(r,851347)).then(e=>e.default)},"/comparison/select/:id":{loader:()=>r.e("9490").then(r.bind(r,851605)).then(e=>e.default),rootComponent:()=>Promise.all([r.e("39366"),r.e("25418"),r.e("31417"),r.e("21398"),r.e("90634")]).then(r.bind(r,838119)).then(e=>e.default)},"/ideas":{loader:()=>Promise.all([r.e("25418"),r.e("996")]).then(r.bind(r,890450)).then(e=>e.default),rootComponent:()=>Promise.all([r.e("39366"),r.e("25418"),r.e("51496"),r.e("31145"),r.e("47336")]).then(r.bind(r,253275)).then(e=>e.default)},"/pin/:id/analytics":{loader:()=>r.e("62315").then(r.bind(r,308821)).then(e=>e.default),rootComponent:()=>Promise.all([r.e("39366"),r.e("25418"),r.e("15417"),r.e("16868"),r.e("17767"),r.e("54960"),r.e("66387"),r.e("38477"),r.e("54097"),r.e("16829")]).then(r.bind(r,234936)).then(e=>e.default)},"/today/":{loader:()=>r.e("42207").then(r.bind(r,415466)).then(e=>e.default),rootComponent:()=>Promise.all([r.e("39366"),r.e("25418"),r.e("51496"),r.e("31145"),r.e("91678")]).then(r.bind(r,352067)).then(e=>e.default)}};function i(e){return(0,n.Gn)(e.kind,e.routeParams)}},335562:function(e,t,r){r.d(t,{Z:()=>function e(t){if(!t||"object"!=typeof t)return t;if(Array.isArray(t))return t.map(e);let r=Object.keys(t).sort(),n={};for(let o=0;o<r.length;o++)n[r[o]]=e(t[r[o]]);return n}})},653015:function(e,t,r){r.d(t,{Z:()=>o,u:()=>n});let n="HIDDEN_ON_SERVER_ERROR",o=e=>e instanceof Object&&"message"in e&&"string"==typeof e.message&&e.message.includes(n)},109571:function(e,t,r){r.d(t,{I:()=>a,t:()=>i});var n=r(667294),o=r(312048);let i=(0,n.createContext)(null);function a(){return(0,o.TH)()===(0,n.use)(i)}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/12608-687de2f99fe40b8f.mjs.map